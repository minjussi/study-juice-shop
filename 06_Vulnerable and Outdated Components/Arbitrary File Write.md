# [β­β­β­β­β­β­] Arbitrary File Write

### π“ Zip Slip

- μ••μ¶• ν•΄μ  κ³Όμ •μ—μ„ λ°μƒν•λ” path traversal μ·¨μ•½μ μΌλ΅, μ¤‘μ”ν• νμΌμ„ λ®μ–΄μ“°κ±°λ‚ μ‹¤ν–‰ κ°€λ¥ν• νμΌμ΄ μ—…λ΅λ“ λλ©΄ μ›κ²© μ½”λ“ μ‹¤ν–‰(RCE)κΉμ§€ κ°€λ¥ν•΄μ§ μ μλ‹¤. 
- κ³µκ²© λ°©μ‹
  1. κ³µκ²©μκ°€ μ••μ¶• νμΌ λ‚΄μ νμΌλ…μ— '../../'μ™€ κ°™μ€ μƒμ„ λ””λ ‰ν† λ¦¬ μ΄λ™ λ¬Έμλ¥Ό ν¬ν•¨μ‹μΌ μ „λ‹¬ν•λ‹¤.
  2. μ΄λ• μ„λ²„κ°€ μ••μ¶•μ„ ν’€ λ• νμΌλ…μ„ κ²€μ‚¬ν•μ§€ μ•μΌλ©΄, κ³µκ²©μκ°€ μλ„ν• κ²½λ΅μ νμΌμ„ λ®μ–΄μ“°κ±°λ‚ μƒμ„±ν•κ² λλ‹¤. 

### π”“ λ¬Έμ  ν’€μ΄

<img width="1145" height="513" alt="image" src="https://github.com/user-attachments/assets/fd61e1ee-033b-45dc-b52f-13eb9a647ac2" />

μ„μ μ½”λ“λ¥Ό λ³΄λ©΄ μ••μ¶• νμΌμ„ ν•΄μ ν•  λ•, μ••μ¶• νμΌ λ‚΄μ— μλ” νμΌλ…μ„ ν™•μΈν•μ§€ μ•κ³  κ·Έλ€λ΅ κ²½λ΅μ— μ¶”κ°€ν•κ³  μλ” κ²ƒμ„ ν™•μΈν•  μ μλ‹¤.

λ”°λΌμ„ μ••μ¶• νμΌ λ‚΄μ νμΌλ…μ„ ../../etc/pwdμ²λΌ path traversalμ΄ κ°€λ¥ν•κ² λ§λ“¤λ©΄, κ²½λ΅λ¥Ό μ΅°μ‘ν•΄ μ„μμ νμΌμ„ μ—…λ΅λ“ν•  μ μκ² λλ‹¤. 

1. legal.mdλΌλ” νμΌμ„ μƒλ΅ λ§λ“ λ‹¤.
2. μ•…μ„± zip νμΌμ„ λ§λ“¤ python μ¤ν¬λ¦½νΈλ¥Ό μ‘μ„±ν•λ‹¤. μ΄λ• legal.md νμΌλ…μ„ ../../ftp/legal.mdλ΅ λ§λ“¤μ–΄ path traversalμ΄ κ°€λ¥ν•κ² λ§λ“ λ‹¤. 
```python
import zipfile

with zipfile.ZipFile('exploit.zip', 'w') as z:
    z.write('legal.md', '../../ftp/legal.md')
```
3. python μ¤ν¬λ¦½νΈλ¥Ό μ‹¤ν–‰ν•΄ exploit.zipμ„ λ§λ“¤κ³ , ν•΄λ‹Ή μ••μ¶• νμΌμ„ complaint νƒ­μ— μ—…λ΅λ“ν•λ‹¤.
4. ftp/legal.md λ””λ ‰ν† λ¦¬μ— μ—…λ΅λ“λ κ²ƒμ„ ν™•μΈν•  μ μλ‹¤.
<img width="400" height="250" alt="image" src="https://github.com/user-attachments/assets/5b6298cd-5eeb-4a46-891c-3c1f347be915" />


### π” Mitigation Strategy

- νμΌλ… μ ν¨μ„± κ²€μ‚¬
    1. νƒ€κ² λ””λ ‰ν† λ¦¬λ¥Ό μ„¤μ •ν•λ‹¤. (μ••μ¶•μ„ ν‘Ό νμΌλ“¤μ΄ μ €μ¥λ  μ„μΉ)
    2. μ••μ¶• νμΌ λ‚΄μ νμΌλ…μΌλ΅ μ λ€ κ²½λ΅λ¥Ό μƒμ„±ν•λ‹¤.
    3. μƒμ„±λ μ λ€ κ²½λ΅κ°€ νƒ€κ² λ””λ ‰ν† λ¦¬λ΅ μ‹μ‘ν•λ”μ§€λ¥Ό ν™•μΈν•μ—¬ νƒμ¶μ„ λ°©μ§€ν•λ‹¤.
 
- νμΌλ… λ‚μν™”: μ‚¬μ©μκ°€ μ¬λ¦° νμΌλ…μ„ κ·Έλ€λ΅ μ‚¬μ©ν•μ§€ μ•κ³ , μ„λ²„μ—μ„ μƒμ„±ν• λλ¤ μ΄λ¦„μΌλ΅ μ €μ¥ν•λ‹¤. 
- μµμ† κ¶ν• μ›μΉ™: μ›Ή μ• ν”λ¦¬μΌ€μ΄μ…μ΄ λ―Όκ°ν• λ””λ ‰ν† λ¦¬μ— μ“°κΈ° κ¶ν•μ„ κ°€μ§€μ§€ μ•λ„λ΅ νμΌ μ‹μ¤ν… κ¶ν•μ„ μ ν•ν•λ‹¤. 
