# [⭐⭐⭐] Payback Time

### 📌 Business Logic Vulnerability

- 애플리케이션의 정상적인 규칙이나 흐름을 악용하여 예상치 못한 동작을 유발하는 결함으로 설계상의 허점(사용자 행동에 대한 잘못된 가정, 복잡한 시스템 등)을 공격자가 이용하는 것이다. 
  - 현재 문제를 예시로 들면, 제품의 수량은 0보다 커야 한다는 상식적인 규칙을 서버가 강제하지 않고 있을 때 취약점이 발생한다.
  - 이외에도 이메일 소유자 확인 절차가 미흡하여 관리자 권한 페이지에 접속이 가능해지거나 관리자 권한으로 로그인이 가능해지는 경우 등이 있다. 

### 📌 Bypassing Client-Side Controls (클라이언트 측 보안 제어 우회)

- 브라우저 단에서 입력을 제한해두어도, 서버로 직접 전달되는 패킷은 조작이 가능하다.
- Burp Suite와 같은 도구를 활용하면 서버 패킷을 가로챌 수 있고, 브라우저의 제한이라는 감옥을 탈출해 서버에 직접 패킷을 보낼 수 있게 된다. 

### 🔓 문제 풀이

- 물건을 장바구니에 추가하고, 장바구니 탭으로 들어가면 수량을 조절할 수 있는 것을 확인할 수 있다. 그러나 프론트에서는 1보다 작은 값으로 내릴 수 없게 되어 있다.
- 따라서 패킷을 중간에 가로채 수량을 음수로 바꿔준다. 

<p align="center">
  <img src="https://github.com/user-attachments/assets/f1b0c945-7840-4576-8f48-6497c88c544e" width="45%" style="margin-right:10px;"/>
  <img src="https://github.com/user-attachments/assets/0240f6fe-6058-4179-b1f8-b6f4b1bae789" width="45%"/>
</p>

- PUT 요청을 보내는 탭에서 수량(quantity)을 지정하는 부분이 있는 것을 확인할 수 있다. 이 부분에서 수량을 음수(-100)로 설정하여 제품 수량을 음수로 만든다.
- 그런 다음 화면을 확인하면 본래 가격에서 음수인 수량을 곱해 가격이 음수(-199)가 된 것을 확인할 수 있다. 이대로 결제를 시도하면 값을 지불하지 않고 물건을 구매할 수 있게 된다. 

<p align="center">
  <img src="https://github.com/user-attachments/assets/bd4e2613-7f35-4e9e-8d84-aae3296e5ac0" width="50%"/>
</p>

- 결제 금액이 음수로 뜨면서 문제가 해결된 것을 확인할 수 있다. 

### 🔐 Mitigation Strategy
